#!/usr/bin/env python3

#
# MIT License
#
# Copyright (c) 2020 EntySec
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#

class formatter:
    def __init__(self):
        self.io = print

    def format_sessions(self, sessions):
        ids = []
        hosts = []
        usernames = []
        for session_id in sessions.keys():
            ids.append(session_id)
            hosts.append(str(sessions[session_id]['host']))
            usernames.append(str(sessions[session_id]['username']))
        bigger_id = len(ids[0])
        for session_id in ids:
            if len(session_id) > bigger_id:
                bigger_id = len(session_id)
        bigger_host = len(hosts[0])
        for host in hosts:
            if len(host) > bigger_host:
                bigger_host = len(host)
        bigger_username = len(usernames[0])
        for username in usernames:
            if len(username) > bigger_username:
                bigger_username = len(username)
        if bigger_id >= 6:
            bigger_id = bigger_id - 0
        else:
            bigger_id = 4
        if bigger_host >= 8:
            bigger_host = bigger_host - 2
        else:
            bigger_host = 4
        if bigger_username >= 12:
            bigger_username = bigger_username - 6
        else:
            bigger_username = 4
            
        self.io("Sessions")
        self.io("========")
        self.io("")
        self.io("    ID" + " " * (bigger_id) + "Host" + " " * (bigger_host) + "Username" + " " * (bigger_username) + "Hostname")
        self.io("    --" + " " * (bigger_id) + "----" + " " * (bigger_host) + "--------" + " " * (bigger_username) + "--------")
        for session_id in ids:
            self.io("    " + str(session_id) + " " * (2 - len(session_id) + bigger_id) + str(sessions[session_id]['host']) + " " * (4 - len(str(sessions[session_id]['host'])) + bigger_host) + str(sessions[session_id]['username']) + " " * (8 - len(str(sessions[session_id]['username'])) + bigger_username) + sessions[session_id]['hostname'])

formatter = formatter()
sessions = {
	'0gfiurgygryrere8t7tr768tr667tr8e67ert6etr6tertr58t58ter58rte857ert7rte75rte685tre6': {
		'host': '192.168.1.95',
		'username': 'enty8080',
		'hostname': 'iMac-Ivan'
	},
	'147843485767634576834567834678345': {
		'host': '192.167.235.12358457435678645367435345',
		'username': 'teleprosheonoenty80825489654667524765246780',
		'hostname': 'ivan'
	}
}
formatter.format_sessions(sessions)
